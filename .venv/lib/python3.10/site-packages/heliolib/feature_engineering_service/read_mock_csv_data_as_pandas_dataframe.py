# src/heliolib/feature_engineering_service/read_mock_csv_data_as_pandas_dataframe.py
import pandas as pd
import os


def fetch_all_valid_dataframes_with_complete_data():
    """
    Fetches all required dataframes from the CSV files.

    Returns:
    -------
    array_info : pd.DataFrame
        The array info dataframe.
    plant_table : pd.DataFrame
        The plant table dataframe.
    inverter_data : pd.DataFrame
        The inverter data dataframe.
    meteo_data : pd.DataFrame
        The meteo data dataframe.
    """
    script_directory = os.path.dirname(os.path.abspath(__file__))
    test_data_directory = os.path.join(script_directory, "test_data")

    # Load plant table
    mock_data_file = os.path.join(
        test_data_directory, "plant_table_plant_id_29_SIG.csv"
    )
    plant_table = pd.read_csv(mock_data_file, index_col=[0, 1])

    # Load array info
    mock_data_file = os.path.join(test_data_directory, "array_info_plant_id_29_SIG.csv")
    array_info = pd.read_csv(mock_data_file, index_col=[0, 1])
    array_info.index = array_info.index.set_levels(
        [array_info.index.levels[0].astype(str), array_info.index.levels[1].astype(str)]
    )

    # Load inverter data
    mock_data_file = os.path.join(
        test_data_directory, "inverter_data_plant_id_29_SIG.csv"
    )
    inverter_data = pd.read_csv(
        mock_data_file,
        index_col=[0],
        header=[0, 1, 2],
    )

    # Load meteo data
    mock_data_file = os.path.join(test_data_directory, "meteo_data_plant_id_29_SIG.csv")
    meteo_data = pd.read_csv(
        mock_data_file,
        index_col=[0],
        header=[0, 1, 2],
    )

    return array_info, plant_table, inverter_data, meteo_data


def fetch_all_valid_dataframes_l1_data():
    """
    Fetches all required dataframes from the CSV files.

    Returns:
    -------
    array_info : pd.DataFrame
        The array info dataframe.
    plant_table : pd.DataFrame
        The plant table dataframe.
    inverter_data : pd.DataFrame
        The inverter data dataframe.
    meteo_data : pd.DataFrame
        The meteo data dataframe.
    """
    script_directory = os.path.dirname(os.path.abspath(__file__))
    test_data_directory = os.path.join(script_directory, "test_data")

    # Load plant table
    mock_data_file = os.path.join(test_data_directory, "plant_table_inverter_level.csv")
    plant_table = pd.read_csv(mock_data_file, index_col=[0])

    # Load array info
    mock_data_file = os.path.join(test_data_directory, "array_info_inverter_level.csv")
    array_info = pd.read_csv(mock_data_file, index_col=[0])
    array_info.index = array_info.index.astype(str)

    # Load inverter data
    mock_data_file = os.path.join(
        test_data_directory, "inverter_data_ac_power_only.csv"
    )
    inverter_data = pd.read_csv(
        mock_data_file,
        header=[0, 1],
        index_col=[0],
    )

    # Load meteo data
    mock_data_file = os.path.join(test_data_directory, "meteo_data_irradiance_only.csv")
    meteo_data = pd.read_csv(
        mock_data_file,
        header=[0, 1],
        index_col=[0],
    )

    mock_data_file = os.path.join(
        test_data_directory, "clearsky_parameters_inverter_only.csv"
    )
    clearsky_data = pd.read_csv(
        mock_data_file,
        header=[0, 1],
        index_col=[0],
    )

    return array_info, plant_table, inverter_data, meteo_data, clearsky_data
