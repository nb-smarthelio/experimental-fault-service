from heliolib.utils.time_zone_info_handler import TimeZoneInfoHandler
import pandas as pd
import pytest


def prepare_empty_valid_data_frame():
    data_frame = pd.DataFrame(index=pd.date_range("2021-01-01", "2021-01-02", freq="H"))
    return data_frame


def prepare_empty_invalid_data_frame():
    data_frame = pd.DataFrame()
    return data_frame


def test_initialization_with_empty_valid_dataframe():
    timezone_handler = TimeZoneInfoHandler()
    assert isinstance(timezone_handler, TimeZoneInfoHandler)


def test_initialization_fails_with_empty_invalid_dataframe():
    empty_invalid_data_frame = prepare_empty_invalid_data_frame()
    with pytest.raises(TypeError) as e_info:
        TimeZoneInfoHandler(empty_invalid_data_frame)
    assert str(e_info.value) == "TimeZoneInfoHandler() takes no arguments"
